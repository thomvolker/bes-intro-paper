{
    "type": [
        2,
        3,
        0,
        1,
        2,
        0,
        1,
        2,
        0,
        1,
        2,
        0,
        1,
        2,
        0,
        1,
        2,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        2,
        3,
        3,
        3,
        3,
        0,
        1,
        2,
        0,
        1,
        2,
        3,
        3,
        3,
        3,
        0,
        1,
        2,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        3,
        3,
        3,
        3,
        0,
        1,
        3,
        3,
        3,
        0,
        1,
        3,
        0,
        1,
        3,
        3,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        2,
        2,
        0,
        1,
        0,
        1,
        3,
        0,
        1,
        3,
        0,
        1,
        2,
        0,
        1,
        2,
        0,
        1,
        2,
        0,
        1,
        3,
        0,
        1,
        2,
        0,
        1,
        2,
        0,
        1,
        2,
        0,
        1,
        2,
        0,
        1,
        2,
        0,
        1,
        2,
        0,
        1,
        3,
        0,
        1,
        0,
        1,
        0,
        1,
        3,
        0,
        1,
        3,
        0,
        1,
        3,
        0,
        1,
        0,
        1,
        0,
        1,
        3,
        0,
        1,
        3,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        2,
        0,
        1,
        0,
        1,
        2,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        2,
        0,
        1,
        2,
        0,
        1,
        2,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        3,
        3,
        3,
        2,
        2,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        3,
        3,
        3,
        2,
        2,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        3,
        3,
        3,
        2,
        2,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        2,
        2,
        0,
        1,
        2,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        2,
        2,
        0,
        1,
        2,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        2,
        2,
        0,
        1,
        2,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        2,
        2,
        0,
        1,
        2,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        2,
        2,
        0,
        1,
        2,
        0,
        1,
        2
    ],
    "data": [
        "\nR version 4.2.1 (2022-06-23 ucrt) -- \"Funny-Looking Kid\"\nCopyright (C) 2022 The R Foundation for Statistical Computing\nPlatform: x86_64-w64-mingw32/x64 (64-bit)\n\nR is free software and comes with ABSOLUTELY NO WARRANTY.\nYou are welcome to redistribute it under certain conditions.\nType 'license()' or 'licence()' for distribution details.\n\nR is a collaborative project with many contributors.\nType 'contributors()' for more information and\n'citation()' on how to cite R or R packages in publications.\n\nType 'demo()' for some demos, 'help()' for on-line help, or\n'help.start()' for an HTML browser interface to help.\nType 'q()' to quit R.\n\n",
        "Error in .rs.parsePackageDependencies(contents, extension) : \n  object 'partition_yaml_front_matter' not found\n",
        "> ",
        ".58 / (1 - .58)",
        "[1] 1.380952\n",
        "> ",
        "(.58 / (1 - .58))",
        "[1] 1.380952\n",
        "> ",
        "(.58 / (1 - .58)) * (.69 / (1 - .69))",
        "[1] 3.073733\n",
        "> ",
        "(.58 / (1 - .58)) * (.69 / (1 - .69)) * (.54 / (1 - .54))",
        "[1] 3.608295\n",
        "> ",
        "3.6 / 4.6",
        "[1] 0.7826087\n",
        "> ",
        "B <- c(1,1,1,2,3)",
        "> ",
        "G <- rep(1, length(B))",
        "> ",
        "Sigma <- diag(length(B))",
        "> ",
        "Sigma[Sigma==0] <- 0.3",
        "> ",
        "VarY <- 0.25",
        "> ",
        "B * sqrt(VarY / t(G) %*% (B %*% t(B) %*% Sigma) %*% G)",
        "[1] 0.04213749 0.04213749 0.04213749 0.08427498 0.12641247\n",
        "Warning message:\n",
        "In B * sqrt(VarY/t(G) %*% (B %*% t(B) %*% Sigma) %*% G) :",
        "\n ",
        " Recycling array of length 1 in vector-array arithmetic is deprecated.\n  Use c() or as.vector() instead.\n\n",
        "> ",
        "sqrt(VarY / t(G) %*% (B %*% t(B) %*% Sigma) %*% G)",
        "           [,1]\n[1,] 0.04213749\n",
        "> ",
        "B * sqrt(VarY / t(G) %*% (B %*% t(B) %*% Sigma) %*% G)",
        "[1] 0.04213749 0.04213749 0.04213749 0.08427498 0.12641247\n",
        "Warning message:\n",
        "In B * sqrt(VarY/t(G) %*% (B %*% t(B) %*% Sigma) %*% G) :",
        "\n ",
        " Recycling array of length 1 in vector-array arithmetic is deprecated.\n  Use c() or as.vector() instead.\n\n",
        "> ",
        "B * c(sqrt(VarY / t(G) %*% (B %*% t(B) %*% Sigma) %*% G))",
        "[1] 0.04213749 0.04213749 0.04213749 0.08427498 0.12641247\n",
        "> ",
        "knitr::opts_chunk$set(echo = TRUE)",
        "> ",
        "## Set seed ",
        "> ",
        "set.seed(123)",
        "> ",
        "",
        "> ",
        "# Load packages",
        "> ",
        "library(tidyverse)",
        "Registered S3 methods overwritten by 'dbplyr':\n  method         from\n  print.tbl_lazy     \n  print.tbl_sql      \n",
        "\u001B[37m── \u001B[1mAttaching packages\u001B[22m ──────────────────────────────────────────────────── tidyverse 1.3.1 ──\u001B[39m\n",
        "\u001B[37m\u001B[32m✔\u001B[37m \u001B[34mggplot2\u001B[37m 3.3.6     \u001B[32m✔\u001B[37m \u001B[34mpurrr  \u001B[37m 0.3.4\n\u001B[32m✔\u001B[37m \u001B[34mtibble \u001B[37m 3.1.7     \u001B[32m✔\u001B[37m \u001B[34mdplyr  \u001B[37m 1.0.9\n\u001B[32m✔\u001B[37m \u001B[34mtidyr  \u001B[37m 1.2.0     \u001B[32m✔\u001B[37m \u001B[34mstringr\u001B[37m 1.4.0\n\u001B[32m✔\u001B[37m \u001B[34mreadr  \u001B[37m 2.1.2     \u001B[32m✔\u001B[37m \u001B[34mforcats\u001B[37m 0.5.1\u001B[39m\n",
        "\u001B[37m── \u001B[1mConflicts\u001B[22m ─────────────────────────────────────────────────────── tidyverse_conflicts() ──\n\u001B[31m✖\u001B[37m \u001B[34mdplyr\u001B[37m::\u001B[32mfilter()\u001B[37m masks \u001B[34mstats\u001B[37m::filter()\n\u001B[31m✖\u001B[37m \u001B[34mdplyr\u001B[37m::\u001B[32mlag()\u001B[37m    masks \u001B[34mstats\u001B[37m::lag()\u001B[39m\n",
        "> ",
        "library(magrittr)",
        "\nAttaching package: ‘magrittr’\n\n",
        "The following object is masked from ‘package:purrr’:\n\n    set_names\n\n",
        "The following object is masked from ‘package:tidyr’:\n\n    extract\n\n",
        "> ",
        "library(furrr)",
        "Loading required package: future\n",
        "> ",
        "library(BFpack)",
        "Loading required package: bain\n",
        "Registered S3 methods overwritten by 'BFpack':\n  method               from\n  get_estimates.lm     bain\n  get_estimates.t_test bain\n",
        "> ",
        "library(Rcpp)",
        "> ",
        "library(RcppArmadillo)",
        "> ",
        "# devtools::build(\"DataCpp\")",
        "> ",
        "# devtools::install(\"DataCpp\")",
        "> ",
        "library(DataCpp)",
        "> ",
        "source(\"functions.R\")",
        "> ",
        "## Number of simulations ",
        "> ",
        "nsim <- 1000",
        "> ",
        "## Sample sizes",
        "> ",
        "n <- 50 * 2^{0:4}",
        "> ",
        "## Models",
        "> ",
        "models <- c(\"normal\", \"logit\", \"probit\")",
        "> ",
        "## r2 of the regression model",
        "> ",
        "r2 <- c(.02, .09, .25)",
        "> ",
        "## Specify relative importance of the regression coefficients",
        "> ",
        "ratio_beta <- c(1,1,1,2,3)",
        "> ",
        "## Specify the bivariate correlations between predictors",
        "> ",
        "pcor <- c(0.3)",
        "> ",
        "gen_dat(0.25, ",
        "+ ",
        "        coefs(0.25, ratio_beta, cormat(pcor, length(ratio_beta)), \"normal\"),",
        "+ ",
        "        cormat(pcor, length(ratio_beta)),",
        "+ ",
        "        100000,",
        "+ ",
        "        \"normal\") %$%",
        "+ ",
        "  lm(Y ~ V1 + V2 + V3 + V4 + V5) %>%",
        "+ ",
        "  summary()",
        "\nCall:\nlm(formula = Y ~ V1 + V2 + V3 + V4 + V5)\n\nResiduals:\n    Min      1Q  Median      3Q     Max \n-3.5925 -0.5807 -0.0008  0.5842  3.7366 \n\nCoefficients:\n             Estimate Std. Error t value Pr(>|t|)    \n(Intercept) 0.0008367  0.0027378   0.306     0.76    \nV1          0.0947298  0.0030354  31.209   <2e-16 ***\nV2          0.0867928  0.0030438  28.514   <2e-16 ***\nV3          0.0910808  0.0030354  30.006   <2e-16 ***\nV4          0.1883437  0.0030404  61.946   <2e-16 ***\nV5          0.2652544  0.0030454",
        "  87.100   <2e-16 ***\n---\nSignif. codes:  0 ‘***’ 0.001 ‘**’ 0.01 ‘*’ 0.05 ‘.’ 0.1 ‘ ’ 1\n\nResidual standard error: 0.8658 on 99994 degrees of freedom\nMultiple R-squared:  0.2517,\tAdjusted R-squared:  0.2516 \nF-statistic:  6725 on 5 and 99994 DF,  p-value: < 2.2e-16\n\n",
        "> ",
        "B * sqrt(VarY / (t(G) %*% (B %*% t(B)) * Sigma) %*% t(G)",
        "+ ",
        ")",
        "Error in t(G) %*% (B %*% t(B)) * Sigma : non-conformable arrays\n",
        "> ",
        "sqrt(VarY / (t(G) %*% (B %*% t(B)) * Sigma) %*% t(G))",
        "Error in t(G) %*% (B %*% t(B)) * Sigma : non-conformable arrays\n",
        "> ",
        "t(G)",
        "     [,1] [,2] [,3] [,4] [,5]\n[1,]    1    1    1    1    1\n",
        "> ",
        "t(G) %*% ((B %*% t(B)))",
        "     [,1] [,2] [,3] [,4] [,5]\n[1,]    8    8    8   16   24\n",
        "> ",
        "t(G) %*% ((B %*% t(B)) * Sigma)",
        "     [,1] [,2] [,3] [,4] [,5]\n[1,]  3.1  3.1  3.1  7.6 13.5\n",
        "> ",
        "t(G) %*% ((B %*% t(B)) * Sigma) %*% t(G)",
        "Error in t(G) %*% ((B %*% t(B)) * Sigma) %*% t(G) : \n  non-conformable arguments\n",
        "> ",
        "t(G) %*% ((B %*% t(B)) * Sigma) %*% G",
        "     [,1]\n[1,] 30.4\n",
        "> ",
        "B * c(sqrt(VarY / (t(G) %*% ((B %*% t(B)) * Sigma) %*% G)))",
        "[1] 0.09068453 0.09068453 0.09068453 0.18136906 0.27205359\n",
        "> ",
        "B * c(sqrt(VarY / (t(G) %*% ((B %*% t(B)) * Sigma) %*% G)))",
        "[1] 0.09068453 0.09068453 0.09068453 0.18136906 0.27205359\n",
        "> ",
        "B * sqrt(VarY / sum(B %*% t(B) * Sigma))",
        "[1] 0.09068453 0.09068453 0.09068453 0.18136906 0.27205359\n",
        "> ",
        "B %*% t(B)",
        "     [,1] [,2] [,3] [,4] [,5]\n[1,]    1    1    1    2    3\n[2,]    1    1    1    2    3\n[3,]    1    1    1    2    3\n[4,]    2    2    2    4    6\n[5,]    3    3    3    6    9\n",
        "> ",
        "B * sqrt(VarY / (sum(B^2 * diag(Sigma)) + sum(2 * B * 0.3)))",
        "[1] 0.1096323 0.1096323 0.1096323 0.2192645 0.3288968\n",
        "> ",
        "for (i in 1:(length(B)-1) {",
        "Error: unexpected '{' in \"for (i in 1:(length(B)-1) {\"\n",
        "> ",
        "    for (j in (min(i+1, length(B)):length(B))) {",
        "+ ",
        "        B[i] * B[j]",
        "+ ",
        "    }",
        "Error in i : object 'i' not found\n",
        "> ",
        "}",
        "Error: unexpected '}' in \"}\"\n",
        "> ",
        "for (i in 1:(length(B)-1) {",
        "Error: unexpected '{' in \"for (i in 1:(length(B)-1) {\"\n",
        "> ",
        "    for (j in (min(i+1, length(B)):length(B))) {",
        "+ ",
        "        B[i] * B[j]",
        "+ ",
        "    }",
        "Error in i : object 'i' not found\n",
        "> ",
        "}",
        "Error: unexpected '}' in \"}\"\n",
        "> ",
        "for (i in 1:(length(B)-1)) {",
        "+ ",
        "    for (j in (min(i+1, length(B)):length(B))) {",
        "+ ",
        "        B[i] * B[j]",
        "+ ",
        "    }",
        "+ ",
        "}",
        "> ",
        "for (i in 1:(length(B)-1)) {",
        "+ ",
        "    for (j in (min(i+1, length(B)):length(B))) {",
        "+ ",
        "        print(B[i] * B[j])",
        "+ ",
        "    }",
        "+ ",
        "}",
        "[1] 1\n[1] 1\n[1] 2\n[1] 3\n[1] 1\n[1] 2\n[1] 3\n[1] 2\n[1] 3\n[1] 6\n",
        "> ",
        "X <- numeric(0)",
        "> ",
        "X",
        "numeric(0)\n",
        "> ",
        "for (i in 1:(length(B)-1)) {",
        "+ ",
        "    for (j in (min(i+1, length(B)):length(B))) {",
        "+ ",
        "        X[length(X) + 1] <- B[i] * B[j]",
        "+ ",
        "    }",
        "+ ",
        "}",
        "> ",
        "X",
        " [1] 1 1 2 3 1 2 3 2 3 6\n",
        "> ",
        "B * sqrt(VarY / (sum(B^2 * diag(Sigma)) + sum(X * 0.3)))",
        "[1] 0.1038068 0.1038068 0.1038068 0.2076137 0.3114205\n",
        "> ",
        "B * sqrt(VarY / (sum(B^2 * diag(Sigma)) + sum(2 * X * 0.3)))",
        "[1] 0.09068453 0.09068453 0.09068453 0.18136906 0.27205359\n",
        "> ",
        "## Set seed ",
        "> ",
        "set.seed(123)",
        "> ",
        "",
        "> ",
        "# Load packages",
        "> ",
        "library(tidyverse)",
        "> ",
        "library(magrittr)",
        "> ",
        "library(furrr)",
        "> ",
        "library(BFpack)",
        "> ",
        "library(Rcpp)",
        "> ",
        "library(RcppArmadillo)",
        "> ",
        "# devtools::build(\"DataCpp\")",
        "> ",
        "# devtools::install(\"DataCpp\")",
        "> ",
        "library(DataCpp)",
        "> ",
        "source(\"functions.R\")",
        "> ",
        "## Sample sizes",
        "> ",
        "n <- 50 * 2^{0:4}",
        "> ",
        "",
        "> ",
        "## Models",
        "> ",
        "models <- c(\"normal\", \"logit\", \"probit\")",
        "> ",
        "",
        "> ",
        "## r2 of the regression model",
        "> ",
        "r2 <- c(.02, .09, .25)",
        "> ",
        "",
        "> ",
        "## Specify relative importance of the regression coefficients",
        "> ",
        "ratio_beta <- c(1,1,1,2,3)",
        "> ",
        "",
        "> ",
        "## Specify the bivariate correlations between predictors",
        "> ",
        "pcor <- c(0.3)",
        "> ",
        "## Number of simulations ",
        "> ",
        "nsim <- 1000",
        "> ",
        "gen_dat(0.02, ",
        "+ ",
        "        coefs(0.02, ratio_beta, cormat(pcor, length(ratio_beta)), \"normal\"),",
        "+ ",
        "        cormat(pcor, length(ratio_beta)),",
        "+ ",
        "        100000,",
        "+ ",
        "        \"normal\") %$%",
        "+ ",
        "  lm(Y ~ V1 + V2 + V3 + V4 + V5) %>%",
        "+ ",
        "  summary()",
        "Warning in ratio * sqrt(var_y/(t(G) %*% (ratio %*% t(ratio) * rho) %*% G)) :",
        "\n ",
        " Recycling array of length 1 in vector-array arithmetic is deprecated.\n  Use c() or as.vector() instead.\n\n",
        "\nCall:\nlm(formula = Y ~ V1 + V2 + V3 + V4 + V5)\n\nResiduals:\n    Min      1Q  Median      3Q     Max \n-4.1066 -0.6638 -0.0010  0.6678  4.2713 \n\nCoefficients:\n             Estimate Std. Error t value Pr(>|t|)    \n(Intercept) 0.0009564  0.0031296   0.306     0.76    \nV1          0.0302735  0.0034697   8.725  < 2e-16 ***\nV2          0.0212009  0.0034794   6.093 1.11e-09 ***\nV3          0.0261024  0.0034697   7.523 5.40e-14 ***\nV4          0.0592716  0.0034755  17.054  < 2e-16 ***\nV5          0.0691763  0.0034812",
        "  19.872  < 2e-16 ***\n---\nSignif. codes:  0 ‘***’ 0.001 ‘**’ 0.01 ‘*’ 0.05 ‘.’ 0.1 ‘ ’ 1\n\nResidual standard error: 0.9897 on 99994 degrees of freedom\nMultiple R-squared:  0.02019,\tAdjusted R-squared:  0.02014 \nF-statistic:   412 on 5 and 99994 DF,  p-value: < 2.2e-16\n\n",
        "> ",
        "gen_dat(0.25, ",
        "+ ",
        "        coefs(0.02, ratio_beta, cormat(pcor, length(ratio_beta)), \"normal\"),",
        "+ ",
        "        cormat(pcor, length(ratio_beta)),",
        "+ ",
        "        100000,",
        "+ ",
        "        \"normal\") %$%",
        "+ ",
        "  lm(Y ~ V1 + V2 + V3 + V4 + V5) %>%",
        "+ ",
        "  summary()",
        "Warning in ratio * sqrt(var_y/(t(G) %*% (ratio %*% t(ratio) * rho) %*% G)) :",
        "\n ",
        " Recycling array of length 1 in vector-array arithmetic is deprecated.\n  Use c() or as.vector() instead.\n\n",
        "\nCall:\nlm(formula = Y ~ V1 + V2 + V3 + V4 + V5)\n\nResiduals:\n    Min      1Q  Median      3Q     Max \n-3.7952 -0.5834 -0.0005  0.5841  3.6361 \n\nCoefficients:\n            Estimate Std. Error t value Pr(>|t|)    \n(Intercept) 0.004440   0.002749   1.615    0.106    \nV1          0.029731   0.003055   9.730   <2e-16 ***\nV2          0.027591   0.003058   9.024   <2e-16 ***\nV3          0.028092   0.003056   9.193   <2e-16 ***\nV4          0.054085   0.003054  17.711   <2e-16 ***\nV5          0.073840   0.003048  24.224",
        "   <2e-16 ***\n---\nSignif. codes:  0 ‘***’ 0.001 ‘**’ 0.01 ‘*’ 0.05 ‘.’ 0.1 ‘ ’ 1\n\nResidual standard error: 0.8694 on 99994 degrees of freedom\nMultiple R-squared:  0.02731,\tAdjusted R-squared:  0.02726 \nF-statistic: 561.5 on 5 and 99994 DF,  p-value: < 2.2e-16\n\n",
        "> ",
        "gen_dat(0.25, ",
        "+ ",
        "        coefs(0.25, ratio_beta, cormat(pcor, length(ratio_beta)), \"normal\"),",
        "+ ",
        "        cormat(pcor, length(ratio_beta)),",
        "+ ",
        "        100000,",
        "+ ",
        "        \"normal\") %$%",
        "+ ",
        "  lm(Y ~ V1 + V2 + V3 + V4 + V5) %>%",
        "+ ",
        "  summary()",
        "Warning in ratio * sqrt(var_y/(t(G) %*% (ratio %*% t(ratio) * rho) %*% G)) :",
        "\n ",
        " Recycling array of length 1 in vector-array arithmetic is deprecated.\n  Use c() or as.vector() instead.\n\n",
        "\nCall:\nlm(formula = Y ~ V1 + V2 + V3 + V4 + V5)\n\nResiduals:\n    Min      1Q  Median      3Q     Max \n-3.5822 -0.5836  0.0020  0.5821  3.9128 \n\nCoefficients:\n              Estimate Std. Error t value Pr(>|t|)    \n(Intercept) -0.0005112  0.0027381  -0.187    0.852    \nV1           0.0878774  0.0030378  28.928   <2e-16 ***\nV2           0.0882019  0.0030478  28.940   <2e-16 ***\nV3           0.0933485  0.0030510  30.596   <2e-16 ***\nV4           0.1822410  0.0030471  59.808   <2e-16 ***\nV5           0.2755055  0.0030451",
        "  90.476   <2e-16 ***\n---\nSignif. codes:  0 ‘***’ 0.001 ‘**’ 0.01 ‘*’ 0.05 ‘.’ 0.1 ‘ ’ 1\n\nResidual standard error: 0.8659 on 99994 degrees of freedom\nMultiple R-squared:  0.2509,\tAdjusted R-squared:  0.2509 \nF-statistic:  6698 on 5 and 99994 DF,  p-value: < 2.2e-16\n\n",
        "> ",
        "coefs <- function(r2, ratio, rho, model = c(\"normal\", \"logit\", \"probit\")) {",
        "+ ",
        "  ",
        "+ ",
        "  # variance of predicted values (Var(yhat))",
        "+ ",
        "  if (model == \"normal\") {",
        "+ ",
        "    var_y <- r2",
        "+ ",
        "  }",
        "+ ",
        "  else if (model == \"logit\") {",
        "+ ",
        "    var_y <- (r2 * pi^2 / 3) / (1 - r2)",
        "+ ",
        "  }",
        "+ ",
        "  else if (model == \"probit\") {",
        "+ ",
        "    var_y <- r2 / (1 - r2)",
        "+ ",
        "  }",
        "+ ",
        "  ",
        "+ ",
        "  G <- rep(1, length(ratio))",
        "+ ",
        "  # value of the regression coefficients",
        "+ ",
        "  ratio * sqrt(c(var_y / (t(G) %*% (ratio %*% t(ratio) * rho) %*% G)))",
        "+ ",
        "}",
        "> ",
        "gen_dat(0.02, ",
        "+ ",
        "        coefs(0.02, ratio_beta, cormat(pcor, length(ratio_beta)), \"normal\"),",
        "+ ",
        "        cormat(pcor, length(ratio_beta)),",
        "+ ",
        "        100000,",
        "+ ",
        "        \"normal\") %$%",
        "+ ",
        "  lm(Y ~ V1 + V2 + V3 + V4 + V5) %>%",
        "+ ",
        "  summary()",
        "\nCall:\nlm(formula = Y ~ V1 + V2 + V3 + V4 + V5)\n\nResiduals:\n    Min      1Q  Median      3Q     Max \n-4.3205 -0.6717 -0.0048  0.6684  4.7131 \n\nCoefficients:\n             Estimate Std. Error t value Pr(>|t|)    \n(Intercept) 0.0005115  0.0031344   0.163     0.87    \nV1          0.0292440  0.0034683   8.432  < 2e-16 ***\nV2          0.0230948  0.0034739   6.648 2.98e-11 ***\nV3          0.0230843  0.0034829   6.628 3.42e-11 ***\nV4          0.0577726  0.0034770  16.616  < 2e-16 ***\nV5          0.0742143  0.0034797",
        "  21.328  < 2e-16 ***\n---\nSignif. codes:  0 ‘***’ 0.001 ‘**’ 0.01 ‘*’ 0.05 ‘.’ 0.1 ‘ ’ 1\n\nResidual standard error: 0.9911 on 99994 degrees of freedom\nMultiple R-squared:  0.02043,\tAdjusted R-squared:  0.02038 \nF-statistic: 417.1 on 5 and 99994 DF,  p-value: < 2.2e-16\n\n",
        "> ",
        "coefs(0.02, ratio_beta, cormat(pcor, length(ratio_beta)), \"normal\")",
        "[1] 0.02564946 0.02564946 0.02564946 0.05129892 0.07694838\n",
        "> ",
        "gen_dat(0.09, ",
        "+ ",
        "        coefs(0.09, ratio_beta, cormat(pcor, length(ratio_beta)), \"logit\"),",
        "+ ",
        "        cormat(pcor, length(ratio_beta)),",
        "+ ",
        "        100000,",
        "+ ",
        "        \"logit\") %$%",
        "+ ",
        "  glm(Y ~ V1 + V2 + V3 + V4 + V5, family = binomial(link = \"logit\")) %T>%",
        "+ ",
        "  {performance::r2_mckelvey(.) %>% print()} %>%",
        "+ ",
        "  summary()",
        "McKelvey's R2 \n   0.09438838 \n\nCall:\nglm(formula = Y ~ V1 + V2 + V3 + V4 + V5, family = binomial(link = \"logit\"))\n\nDeviance Residuals: \n    Min       1Q   Median       3Q      Max  \n-2.0450  -1.1132  -0.5252   1.1112   2.0580  \n\nCoefficients:\n             Estimate Std. Error z value Pr(>|z|)    \n(Intercept) -0.002938   0.006571  -0.447    0.655    \nV1           0.109117   0.007303  14.942   <2e-16 ***\nV2           0.111536   0.007302  15.274   <2e-16 ***\nV3           0.102515   0.007319  14.006   <2e-16 ***",
        "\nV4           0.219457   0.007364  29.801   <2e-16 ***\nV5           0.310888   0.007440  41.784   <2e-16 ***\n---\nSignif. codes:  0 ‘***’ 0.001 ‘**’ 0.01 ‘*’ 0.05 ‘.’ 0.1 ‘ ’ 1\n\n(Dispersion parameter for binomial family taken to be 1)\n\n    Null deviance: 138629  on 99999  degrees of freedom\nResidual deviance: 130999  on 99994  degrees of freedom\nAIC: 131011\n\nNumber of Fisher Scoring iterations: 4\n\n",
        "> ",
        "coefs(0.09, ratio_beta, cormat(pcor, length(ratio_beta)), \"logit\")",
        "[1] 0.1034554 0.1034554 0.1034554 0.2069107 0.3103661\n",
        "> ",
        "gen_dat(0.25, ",
        "+ ",
        "        coefs(0.25, ratio_beta, cormat(pcor, length(ratio_beta)), \"probit\"),",
        "+ ",
        "        cormat(pcor, length(ratio_beta)),",
        "+ ",
        "        100000,",
        "+ ",
        "        \"probit\") %$%",
        "+ ",
        "  glm(Y ~ V1 + V2 + V3, family = binomial(link = \"probit\")) %T>%",
        "+ ",
        "  {performance::r2_mckelvey(.) %>% print()} %>%",
        "+ ",
        "  summary()",
        "McKelvey's R2 \n    0.1474677 \n\nCall:\nglm(formula = Y ~ V1 + V2 + V3, family = binomial(link = \"probit\"))\n\nDeviance Residuals: \n    Min       1Q   Median       3Q      Max  \n-2.3961  -1.0924  -0.3969   1.0938   2.4396  \n\nCoefficients:\n              Estimate Std. Error z value Pr(>|z|)    \n(Intercept) -0.0004059  0.0040838  -0.099    0.921    \nV1           0.1923110  0.0044706  43.016   <2e-16 ***\nV2           0.1897917  0.0044662  42.495   <2e-16 ***\nV3           0.1869640  0.0044470  42.043   <2e-16 ***\n---\nSignif. codes:  ",
        "0 ‘***’ 0.001 ‘**’ 0.01 ‘*’ 0.05 ‘.’ 0.1 ‘ ’ 1\n\n(Dispersion parameter for binomial family taken to be 1)\n\n    Null deviance: 138629  on 99999  degrees of freedom\nResidual deviance: 128759  on 99996  degrees of freedom\nAIC: 128767\n\nNumber of Fisher Scoring iterations: 4\n\n",
        "> ",
        "coefs(0.25, ratio_beta, cormat(pcor, length(ratio_beta)), \"probit\")",
        "[1] 0.1047135 0.1047135 0.1047135 0.2094270 0.3141404\n",
        "> ",
        "gen_dat(0.25, ",
        "+ ",
        "        coefs(0.25, ratio_beta, cormat(pcor, length(ratio_beta)), \"probit\"),",
        "+ ",
        "        cormat(pcor, length(ratio_beta)),",
        "+ ",
        "        100000,",
        "+ ",
        "        \"probit\") %$%",
        "+ ",
        "  glm(Y ~ V1 + V2 + V3 + V4 + V5, family = binomial(link = \"probit\")) %T>%",
        "+ ",
        "  {performance::r2_mckelvey(.) %>% print()} %>%",
        "+ ",
        "  summary()",
        "McKelvey's R2 \n    0.2504008 \n\nCall:\nglm(formula = Y ~ V1 + V2 + V3 + V4 + V5, family = binomial(link = \"probit\"))\n\nDeviance Residuals: \n    Min       1Q   Median       3Q      Max  \n-2.7523  -1.0270   0.2965   1.0259   2.7828  \n\nCoefficients:\n            Estimate Std. Error z value Pr(>|z|)    \n(Intercept) 0.008294   0.004189    1.98   0.0477 *  \nV1          0.106073   0.004669   22.72   <2e-16 ***\nV2          0.107578   0.004674   23.02   <2e-16 ***\nV3          0.110848   0.004677   23.70   <2e-16 ***\nV4         ",
        " 0.209478   0.004700   44.57   <2e-16 ***\nV5          0.307101   0.004784   64.20   <2e-16 ***\n---\nSignif. codes:  0 ‘***’ 0.001 ‘**’ 0.01 ‘*’ 0.05 ‘.’ 0.1 ‘ ’ 1\n\n(Dispersion parameter for binomial family taken to be 1)\n\n    Null deviance: 138628  on 99999  degrees of freedom\nResidual deviance: 121220  on 99994  degrees of freedom\nAIC: 121232\n\nNumber of Fisher Scoring iterations: 3\n\n",
        "> ",
        "coefs(0.25, ratio_beta, cormat(pcor, length(ratio_beta)), \"probit\")",
        "[1] 0.1047135 0.1047135 0.1047135 0.2094270 0.3141404\n",
        "> ",
        "gen_dat(0.25, ",
        "+ ",
        "        coefs(0.25, ratio_beta, cormat(pcor, length(ratio_beta)), \"probit\"),",
        "+ ",
        "        cormat(pcor, length(ratio_beta)),",
        "+ ",
        "        100000,",
        "+ ",
        "        \"probit\") %$%",
        "+ ",
        "  glm(Y ~ V1 + V2 + V3 + V4 + V5, family = binomial(link = \"probit\")) %T>%",
        "+ ",
        "  {performance::r2_mckelvey(.) %>% print()} %>%",
        "+ ",
        "  summary()",
        "McKelvey's R2 \n    0.2521096 \n\nCall:\nglm(formula = Y ~ V1 + V2 + V3 + V4 + V5, family = binomial(link = \"probit\"))\n\nDeviance Residuals: \n    Min       1Q   Median       3Q      Max  \n-2.9466  -1.0233  -0.3274   1.0285   2.5417  \n\nCoefficients:\n             Estimate Std. Error z value Pr(>|z|)    \n(Intercept) -0.006587   0.004191  -1.572    0.116    \nV1           0.104546   0.004683  22.326   <2e-16 ***\nV2           0.107975   0.004677  23.085   <2e-16 ***\nV3           0.101011   0.004668  21.638   <2e-16 ***",
        "\nV4           0.209409   0.004716  44.404   <2e-16 ***\nV5           0.317069   0.004781  66.324   <2e-16 ***\n---\nSignif. codes:  0 ‘***’ 0.001 ‘**’ 0.01 ‘*’ 0.05 ‘.’ 0.1 ‘ ’ 1\n\n(Dispersion parameter for binomial family taken to be 1)\n\n    Null deviance: 138626  on 99999  degrees of freedom\nResidual deviance: 121116  on 99994  degrees of freedom\nAIC: 121128\n\nNumber of Fisher Scoring iterations: 3\n\n",
        "> ",
        "coefs(0.25, ratio_beta, cormat(pcor, length(ratio_beta)), \"probit\")",
        "[1] 0.1047135 0.1047135 0.1047135 0.2094270 0.3141404\n",
        "> ",
        "plan(sequential)",
        "\nRestarting R session...\n\n"
    ]
}